# 功能：候选筛选与排序

## 概述

对融合评分后的候选进行排序和筛选，返回 top-k 结果。**是否需要澄清由后续大模型判断**，本模块仅提供轻量提示（hint）供参考。

## 设计原则

- **职责单一**：只做排序和截断，不做澄清决策
- **最小信息**：仅返回 `hint` 提示，避免信息过载影响大模型注意力
- **泛化性**：澄清判断交给大模型，可结合更多上下文做出更好决策

## 新增需求

### 需求：Top-K 筛选

系统必须按总分降序排列候选，并返回前 k 个结果。

#### 场景：返回排序后的 Top-K

- 给定：候选列表包含 lamp-1（score=0.90）、lamp-2（score=0.70）、lamp-3（score=0.50）
- 且：top_k = 2
- 当：执行筛选
- 则：结果应包含 lamp-1 和 lamp-2
- 且：lamp-1 应排在第一位

### 需求：分数接近提示

当 top1 和 top2 分数接近时，系统应返回 hint 供大模型参考。

#### 场景：分差不足返回提示

- 给定：候选列表包含 lamp-1（score=0.80）和 lamp-2（score=0.78）
- 且：close_threshold 为 0.1
- 当：执行筛选
- 则：hint 应为 "multiple_close_matches"

#### 场景：分差足够无提示

- 给定：候选列表包含 lamp-1（score=0.90）和 lamp-2（score=0.60）
- 当：执行筛选
- 则：hint 应为 None

### 需求：空结果处理

当没有召回候选时，返回空列表。

#### 场景：无候选返回空

- 给定：候选列表为空
- 当：执行筛选
- 则：结果列表应为空
- 且：hint 应为 None

## 相关功能

- [context-retrieval](../context-retrieval/spec.md)
